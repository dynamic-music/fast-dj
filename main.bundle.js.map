{"version":3,"sources":["/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/$_gendir lazy","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/api.service.ts","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/app.component.css","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/app.component.html","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/app.component.ts","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/app.module.ts","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/dev-controls/dev-controls.component.css","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/dev-controls/dev-controls.component.html","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/dev-controls/dev-controls.component.ts","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/feature-extraction.service.ts","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/mix/analyzer.ts","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/mix/auto-dj.ts","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/mix/mix-generator.ts","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/mix/types.ts","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/util.ts","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/environments/environment.ts","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/main.ts","/Users/flo/Projects/Code/FAST/fast-dj/fast-dj/node_modules/n3/lib ^\\.\\/N3.*$","util (ignored)","vertx (ignored)"],"names":[],"mappings":"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","file":"main.bundle.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\treturn new Promise(function(resolve, reject) { reject(new Error(\"Cannot find module '\" + req + \"'.\")); });\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"../../../../../src/$$_gendir lazy recursive\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/$$_gendir lazy\n// module id = ../../../../../src/$$_gendir lazy recursive\n// module chunks = main","import { Injectable } from '@angular/core';\nimport { Transition } from './mix/types';\n\n@Injectable()\nexport class ApiService {\n\n  private API_URL = \"https://fast-dj.herokuapp.com/\";//\"http://localhost:8060/\";\n\n  addTransition(transition: Transition) {\n    //TODO ADD TIME!!!!!!!!!\n    return this.postJsonToApi('transition', transition);\n  }\n\n  getAllTransitions(): Promise<Transition[]> {\n    return this.getJsonFromApi('transitions');\n  }\n\n  private postJsonToApi(path: string, json: {}, params?: {}) {\n    path = this.addParams(path, params);\n    return fetch(this.API_URL+path, {\n      method: 'post',\n      body: JSON.stringify(json),\n      headers: { 'Content-Type': 'application/json' }\n    })\n      .then(r => r.text())\n      //.then(r => {console.log(r); return r})\n      .then(t => JSON.parse(t))\n      .catch(e => console.log(e));\n  }\n\n  private getJsonFromApi(path: string, params?: {}): Promise<any> {\n    path = this.addParams(path, params);\n    return fetch(this.API_URL+path)\n      .then(r => r.text())\n      .then(t => JSON.parse(t))\n      .catch(e => console.log(e));\n  }\n\n  private addParams(path, params?: {}) {\n    if (params) {\n      let paramStrings = Array.from(Object.keys(params))\n        .map(k => k+\"=\"+encodeURIComponent(params[k]));\n      path += '?'+paramStrings.join('&');\n    }\n    return path;\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/api.service.ts","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".custom-component-drop-zone {\\n  width: 100%;\\n  height: 100%;\\n  font-size: 50px;\\n  font-family: \\\"Comic Sans MS\\\";\\n  text-align: center;\\n}\\n\\n.status-indicator {\\n  width: 100%;\\n  height: 100%;\\n  opacity: 0.9;\\n  overflow: auto;\\n  transition: background-color 0.1s ease-in-out;\\n}\\n\\n.beat {\\n  opacity: 1.0;\\n}\", \"\"]);\n\n// exports\n\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = module.exports.toString();\n\n\n//////////////////\n// WEBPACK FOOTER\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/app.component.css\n// module id = ../../../../../src/app/app.component.css\n// module chunks = main","module.exports = \"<!--The content below is only a placeholder and can be replaced.-->\\n<div\\n  ng2FileDrop\\n  class=\\\"custom-component-drop-zone\\\"\\n  (ng2FileDropFileAccepted)=\\\"dragFileAccepted($event)\\\"\\n>\\n  <div\\n    [ngClass]=\\\"{beat: state.status.type === 'SPINNING', 'status-indicator': true}\\\"\\n    [style.backgroundColor]=\\\"state.status.colour\\\"\\n  >\\n    <h1>FAST DJ</h1>\\n    <h2>{{state.status.type}}</h2>\\n    <p>{{state.status.message}}</p>\\n    <!--[hidden]=\\\"!transitionDone || ratingDone\\\"-->\\n    <star-rating [hidden]=\\\"!transitionDone || ratingDone\\\"\\n      [rating]=\\\"lastTransitionRating\\\"\\n      (ratingChange)=\\\"lastTransitionRating = $event.rating\\\"\\n      (starClickChange)=\\\"onRatingChange($event)\\\"\\n       labelText=\\\"last transition rating\\\"\\n      size=\\\"large\\\" labelPosition=\\\"bottom\\\" staticColor=\\\"default\\\" starType=\\\"svg\\\">\\n    </star-rating>\\n    <p [hidden]=\\\"!ratingDone\\\">drop more audio</p>\\n    <dj-dev-controls *ngIf=\\\"state.inDevMode\\\">Text to show</dj-dev-controls>\\n  </div>\\n</div>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/app.component.html\n// module id = ../../../../../src/app/app.component.html\n// module chunks = main","import { Component, OnInit } from '@angular/core';\nimport { Ng2FileDropAcceptedFile } from 'ng2-file-drop';\nimport { ActivatedRoute } from '@angular/router';\nimport { ApiService } from './api.service';\nimport { FeatureExtractionService } from './feature-extraction.service';\nimport { getGuid } from './util';\nimport { Transition, DecisionType } from './mix/types';\nimport { AutoDj } from './mix/auto-dj';\n\nfunction* createColourCycleIterator(colours: string[]) {\n  let index = 0;\n  const nColours = colours.length;\n  while (true) {\n    yield colours[index = ++index % nColours];\n  }\n}\n\ninterface StatusIndictator {\n  colour: string;\n  message: string;\n  type: string;\n}\n\ninterface AppState {\n  inDevMode: boolean;\n  status: StatusIndictator;\n}\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent implements OnInit  {\n  private cyclicColours: Iterator<string>;\n  private currentState: AppState;\n  private songNames: string[] = [];\n  private lastTransition: Transition;\n  private lastTransitionRating: number = 0;\n  private transitionDone: boolean = false;\n  private ratingDone: boolean = false;\n  private dj: AutoDj;\n\n  private get state(): AppState {\n    return this.currentState;\n  }\n  private set state(newState: AppState) {\n    this.currentState = newState;\n  }\n\n  private set status(type: string) {\n    const status = {\n      ...this.state.status,\n      type\n    };\n    this.state = {\n      ...this.state,\n      status\n    };\n  }\n  private set message(message: string) {\n    const status = {\n      ...this.state.status,\n      colour: this.getNextColour(),\n      message\n    };\n    this.state = {\n      ...this.state,\n      status\n    };\n  }\n\n  constructor(private route: ActivatedRoute,\n      private apiService: ApiService,\n      private extractionService: FeatureExtractionService) {\n    //GlobalVars.LOGGING_ON = true;\n    this.cyclicColours = createColourCycleIterator([\n      '#5bc0eb',\n      '#fde74c',\n      '#9bc53d',\n      '#e55934',\n      '#fa7921'\n    ]);\n    this.state = {\n      inDevMode: false,\n      status: {\n        type: 'INITIALISING',\n        message: 'loading',\n        colour: this.getNextColour()\n      }\n    };\n  }\n\n  async ngOnInit() {\n    this.route\n    .queryParamMap\n    .map(params => {\n      this.state = {\n        ...this.state,\n        inDevMode: params.has('dev')\n      };\n    })\n    .subscribe();\n\n    this.dj = new AutoDj(null, this.extractionService);\n    await this.dj.init();\n    this.status = 'READY';\n    this.message = 'drop audio here';\n    this.dj.getBeatObservable()\n      .subscribe(b => {\n        this.status = this.state.status.type === \"SPINNING\" ?\n          \"spinning\" : \"SPINNING\";\n      })\n  }\n\n  private async dragFileAccepted(acceptedFile: Ng2FileDropAcceptedFile) {\n    //TODO RECATIVATE MANDATORY RATING!!! if (this.ratingDone || this.state.status.type === 'READY') {\n      this.transitionDone = false;\n      this.ratingDone = false;\n      this.lastTransitionRating = 0;\n      const url = URL.createObjectURL(acceptedFile.file);\n      this.songNames.push(acceptedFile.file.name);\n      this.message = (\"checking out \"+acceptedFile.file.name).toLowerCase();\n      this.lastTransition = await this.dj.transitionToSong(url);\n      this.message = \"transitioning to \" + acceptedFile.file.name.toLowerCase();\n      //when transition done:\n      setTimeout(() => {\n        this.transitionDone = true;\n        this.message = \"playing \" + acceptedFile.file.name.toLowerCase();\n      }, this.lastTransition.duration*1000 + 3000);\n    }\n  //}\n\n  private onRatingChange(event) {\n    if (this.lastTransition) {\n      this.lastTransition.user = getGuid();\n      this.lastTransition.rating = event.rating;\n      this.lastTransition.names = this.songNames.slice(-2);\n      this.apiService.addTransition(this.lastTransition);\n      setTimeout(() => this.ratingDone = true, 2000);\n    }\n  }\n\n  private getNextColour(): string {\n    return this.cyclicColours.next().value;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/app.component.ts","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { AppComponent } from './app.component';\nimport { Ng2FileDropModule } from 'ng2-file-drop';\nimport { ApiService } from './api.service';\nimport { FeatureExtractionService } from './feature-extraction.service';\nimport { RouterModule, Routes } from '@angular/router';\nimport { DevControlsComponent } from './dev-controls/dev-controls.component';\nimport { StarRatingModule } from 'angular-star-rating';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    DevControlsComponent\n  ],\n  imports: [\n    BrowserModule,\n    Ng2FileDropModule,\n    RouterModule.forRoot([]),\n    StarRatingModule.forRoot()\n  ],\n  providers: [\n    ApiService,\n    FeatureExtractionService\n  ],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n\n\n\n// WEBPACK FOOTER //\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/app.module.ts","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"\", \"\"]);\n\n// exports\n\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = module.exports.toString();\n\n\n//////////////////\n// WEBPACK FOOTER\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/dev-controls/dev-controls.component.css\n// module id = ../../../../../src/app/dev-controls/dev-controls.component.css\n// module chunks = main","module.exports = \"<p>\\n  dev-controls works!\\n</p>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/dev-controls/dev-controls.component.html\n// module id = ../../../../../src/app/dev-controls/dev-controls.component.html\n// module chunks = main","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'dj-dev-controls',\n  templateUrl: './dev-controls.component.html',\n  styleUrls: ['./dev-controls.component.css']\n})\nexport class DevControlsComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/dev-controls/dev-controls.component.ts","import { Injectable } from '@angular/core';\nimport {\n  OneShotExtractionClient,\n  OneShotExtractionRequest as Request,\n  OneShotExtractionResponse as Response,\n  OneShotExtractionScheme\n} from 'piper-js/one-shot';\n//import { FeatureList } from 'piper-js/core';\nimport { toSeconds } from 'piper-js/time';\nimport createQmWorker from '@extractors/qm';\nimport { FeatureExtractor, Beat, Key } from './mix/types';\n\n// this spawns a web worker, which we only want to do once\n// so we instantiate\nconst qmWorker = createQmWorker();\n\nexport interface QmExtractor {\n  key: string,\n  outputId: string\n}\n\ninterface AudioData {\n  channels: Float32Array[];\n  sampleRate: number;\n  duration: number;\n}\n\nfunction bufferToAudioData(buffer: AudioBuffer): AudioData {\n  const nChannels = buffer.numberOfChannels;\n  const channels = new Array<Float32Array>(nChannels);\n  for (let i = 0; i < nChannels; ++i) {\n    channels[i] = buffer.getChannelData(i);\n  }\n  return {\n    channels,\n    sampleRate: buffer.sampleRate,\n    duration: buffer.duration\n  };\n}\n\n@Injectable()\nexport class FeatureExtractionService implements FeatureExtractor {\n  private client: OneShotExtractionClient;\n\n  constructor() {\n    this.client = new OneShotExtractionClient(\n      qmWorker,\n      OneShotExtractionScheme.REMOTE\n    );\n  }\n\n  extract(request: Request): Promise<Response> {\n    return this.client.collect(request);\n  }\n\n  private extractQmFeature(buffer: AudioBuffer, feature: QmExtractor): Promise<any> {\n    const {channels, sampleRate} = bufferToAudioData(buffer);\n    return this.extract({\n      audioData: channels,\n      audioFormat: {\n        sampleRate,\n        channelCount: channels.length\n      },\n      key: feature.key,\n      outputId: feature.outputId\n    }).then(response => response.features.collected);\n  }\n\n  extractBeats(buffer: AudioBuffer): Promise<Beat[]> {\n    return this.extractQmFeature(buffer, {\n      key: 'qm-vamp-plugins:qm-barbeattracker',\n      outputId: 'beats'\n    }).then(features => features.map(feature => ({\n      time: {value: toSeconds(feature.timestamp)},\n      label: {value: feature.label}\n    })));\n  }\n\n  extractKey(buffer: AudioBuffer): Promise<Key[]> {\n    return this.extractQmFeature(buffer, {\n      key: 'qm-vamp-plugins:qm-keydetector',\n      outputId: 'tonic'\n    }).then(features => features.map(feature => ({\n      time: {value: toSeconds(feature.timestamp)},\n      value: feature.featureValues[0]\n    })));\n  }\n}\n\n\n// WEBPACK FOOTER //\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/feature-extraction.service.ts","import * as _ from 'lodash';\nimport * as math from 'mathjs';\nimport { SuperDymoStore, uris } from 'dymo-core';\n\nexport interface Pair<T> {\n  first: T,\n  second: T\n}\n\n/* {[0]: 0, [7,5]: 1, [2,10]: 2, [9,3]: 3, [4,8]: 4, [11,1]: 5, [6]: 6} */\nconst TONAL_DISTANCES = {\n  0: 0,\n  1: 5,\n  2: 2,\n  3: 3,\n  4: 4,\n  5: 1,\n  6: 6,\n  7: 1,\n  8: 4,\n  9: 3,\n  10: 2,\n  11: 5\n}\n\nexport class Analyzer {\n\n  private beatsCache: Map<string, number[]> = new Map<string, number[]>();\n  private keysCache: Map<string, number> = new Map<string, number>();\n  private tempoCache: Map<string, number> = new Map<string, number>();\n\n  constructor(private store: SuperDymoStore) {}\n\n  async getAllFeatures(song1: string, song2: string): Promise<number[]> {\n    return [\n      await this.getTempo(song1),\n      await this.getTempo(song2),\n      await this.getTempoRatio(song1, song2),\n      await this.getTempoRatio(song2, song1),\n      await this.getTempoMultiple(song1, song2),\n      await this.getTempoMultiple(song2, song1),\n      await this.getRegularity(song1),\n      await this.getRegularity(song2),\n      await this.getKey(song1),\n      await this.getKey(song2),\n      await this.getKeyDistance(song1, song2)\n    ]\n  }\n\n  getMainSongBody(songUri: string): Pair<number> {\n    return {first:0,second:1};\n  }\n\n  async getKeyDistance(song1Uri: string, song2Uri: string): Promise<number> {\n    let dist = Math.abs(await this.getKey(song1Uri) - await this.getKey(song2Uri));\n    return TONAL_DISTANCES[dist];\n  }\n\n  async getKey(songUri: string): Promise<number> {\n    if (!this.keysCache.has(songUri)) {\n      let key = await this.store.findFeatureValue(songUri, uris.CONTEXT_URI+\"key\");\n      this.keysCache.set(songUri, key.length ? key[0] : key);\n    }\n    return this.keysCache.get(songUri);\n  }\n\n  async getTempo(songUri: string): Promise<number> {\n    if (!this.tempoCache.has(songUri)) {\n      const durations = await this.getBeatDurations(songUri);\n      this.tempoCache.set(songUri, 60/math.mean(durations));\n    }\n    return this.tempoCache.get(songUri);\n  }\n\n  async getTempoMultiple(song1Uri: string, song2Uri: string): Promise<number> {\n    const tempoRatio = await this.getTempoRatio(song1Uri, song2Uri);\n    return tempoRatio % 1;\n  }\n\n  async getTempoRatio(song1Uri: string, song2Uri: string): Promise<number> {\n    const tempoRatio = await this.getTempo(song1Uri) / await this.getTempo(song2Uri);\n    //console.log(\"tempo ratio\", tempoRatio);\n    return tempoRatio;\n  }\n\n  async hasRegularBeats(songUri: string): Promise<boolean> {\n    return await this.getRegularity(songUri) < .1;\n  }\n\n  async getRegularity(songUri: string): Promise<number> {\n    const durations = await this.getBeatDurations(songUri);\n    return math.std(durations);\n  }\n\n  async tempoSimilar(song1Uri: string, song2Uri: string): Promise<boolean> {\n    const ratio = await this.getTempoRatio(song1Uri, song2Uri);\n    return this.isSimilar(1, ratio);\n  }\n\n  private isSimilar(n1: number, n2: number): boolean {\n    //TODO MAKE POWER-BASED DISTANCE\n    return Math.abs(n1 - n2) < .1;\n  }\n\n  private async getBeatDurations(songUri: string): Promise<number[]> {\n    if (!this.beatsCache.has(songUri)) {\n      const bars = await this.store.findParts(songUri);\n      const beats = _.flatten(await Promise.all(bars.map(p => this.store.findParts(p))));\n      const durations = await Promise.all<number>(beats.map(b => this.findDuration(b)));\n      this.beatsCache.set(songUri, durations);\n    }\n    return this.beatsCache.get(songUri);\n  }\n\n  private async findDuration(dymo: string): Promise<number> {\n    return <number>(await this.store.findFeatureValue(dymo, uris.DURATION_FEATURE));\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/mix/analyzer.ts","import { Observable } from 'rxjs/Observable';\nimport * as _ from 'lodash';\nimport { DymoPlayer } from 'dymo-player';\nimport { DymoGenerator, DymoTemplates, SuperDymoStore, globals } from 'dymo-core';\nimport { MixGenerator } from './mix-generator';\nimport { FeatureExtractor, Transition, TransitionType, DecisionType } from './types';\nimport { Analyzer } from './analyzer';\n\n\nexport class AutoDj {\n\n  private store: SuperDymoStore;\n  private analyzer: Analyzer;\n  private dymoGen: DymoGenerator;\n  private mixGen: MixGenerator;\n  private player: DymoPlayer;\n  private previousPlayingDymos = [];\n  private previousSongs = [];\n\n  //TODO AT SOME POINT IN THE FUTURE WE MAY HAVE AN API WITH SOME FEATURES\n  constructor(private featureApi: string, private featureExtractor: FeatureExtractor,\n      private decisionType?: DecisionType) {\n    this.player = new DymoPlayer(true, false, 0.5, 2)//, undefined, undefined, true);\n  }\n\n  init(): Promise<any> {\n    return this.player.init('https://raw.githubusercontent.com/dynamic-music/dymo-core/master/ontologies/')//'https://dynamic-music.github.io/dymo-core/ontologies/')\n      .then(() => {\n        this.store = this.player.getDymoManager().getStore();\n        this.dymoGen = new DymoGenerator(false, this.store);\n        this.mixGen = new MixGenerator(this.dymoGen, this.player);\n        this.analyzer = new Analyzer(this.store);\n      });\n  }\n\n  getBeatObservable(): Observable<any> {\n    return (this.player.getPlayingDymoUris())\n      .filter(playingDymos => {\n        // TODO identify which track is playing, and associate with a specific colour\n       const nChanged = _.difference(playingDymos, this.previousPlayingDymos).length;\n       this.previousPlayingDymos = playingDymos;\n       return nChanged > 0;\n      });\n  }\n\n  async transitionToSong(audioUri: string): Promise<Transition> {\n    let buffer = await (await this.player.getAudioBank()).getAudioBuffer(audioUri);\n    let beats = await this.featureExtractor.extractBeats(buffer);\n    //drop initial and final incomplete bars\n    beats = _.dropWhile(beats, b => b.label.value !== \"1\");\n    beats = _.dropRightWhile(beats, b => b.label.value !== \"4\");\n    let newSong = await DymoTemplates.createAnnotatedBarAndBeatDymo2(this.dymoGen, audioUri, beats);\n    let oldSong = this.previousSongs.length ? _.last(this.previousSongs) : undefined;\n    let keys = await this.featureExtractor.extractKey(buffer);\n    this.dymoGen.setSummarizingMode(globals.SUMMARY.MODE);\n    await this.dymoGen.addFeature(\"key\", keys, newSong);\n    let transition = await this.internalTransition(newSong);\n    if (oldSong) {\n      transition.features = await this.analyzer.getAllFeatures(oldSong, newSong);\n    }\n    return transition;\n  }\n\n  private async internalTransition(newSong: string): Promise<Transition> {\n    //stopped playing, reset\n    if (this.previousSongs.length > 0 && !this.player.isPlaying(this.mixGen.getMixDymo())) {\n      this.previousSongs = [];\n      await this.mixGen.init();\n    }\n    await this.player.getDymoManager().loadFromStore(newSong);\n\n    let transition: Transition;\n    if (this.decisionType == DecisionType.Default) {\n      transition = await this.defaultTransition(newSong);\n    } else if (this.decisionType == DecisionType.Random) {\n      transition = await this.randomTransition(newSong);\n    } else if (this.decisionType == DecisionType.DecisionTree) {\n      transition = await this.startWhicheverTransitionIsBest(newSong);\n    } else {\n      //fiftyfifty random and decision tree\n      transition = Math.random() > 0.5 ? await this.randomTransition(newSong)\n        : await this.startWhicheverTransitionIsBest(newSong);\n    }\n    this.previousSongs.push(newSong);\n    this.player.playUri(this.mixGen.getMixDymo());\n    return transition;\n  }\n\n  private async defaultTransition(newSong: string): Promise<Transition> {\n    let transition: Transition;\n    if (this.previousSongs.length > 0) {\n      //transition = await this.startWhicheverTransitionIsBest(newSong);\n      //transition = await this.randomTransition(newSong);\n      transition = await this.mixGen.beatmatchCrossfade(newSong);\n    } else {\n      transition = await this.mixGen.startMixWithFadeIn(newSong);\n    }\n    transition.decision = DecisionType.Default;\n    return transition;\n  }\n\n  private async randomTransition(newSong: string): Promise<Transition> {\n    console.log(\"random\")\n    let transition: Transition;\n    if (this.previousSongs.length > 0) {\n      transition = await this.getRandomTransition()(newSong);\n    } else {\n      transition = await this.mixGen.startMixWithFadeIn(newSong);\n    }\n    transition.decision = DecisionType.Random;\n    return transition;\n  }\n\n  private async startWhicheverTransitionIsBest(newSong: string): Promise<Transition> {\n    console.log(\"tree\")\n    let transition: Transition;\n    const previousSong = _.last(this.previousSongs);\n\n    if (this.previousSongs.length == 0) {\n      transition = await this.mixGen.startMixWithFadeIn(newSong);\n    } else {\n      //const songBoundaries = this.analyzer.getMainSongBody(newSong);\n      if (await this.analyzer.hasRegularBeats(newSong) && await this.analyzer.hasRegularBeats(previousSong)) {\n        console.log(\"both regular\")\n        if (await this.analyzer.tempoSimilar(newSong, previousSong)) {\n          console.log(\"tempo similar\")\n          //transition using beatmatching and tempo interpolation\n          transition = await this.mixGen.beatmatchCrossfade(newSong);\n        }/* else if (await analyzer.tempoCloseToMultiple(newSong, previousSong)) {\n          console.log(\"tempo multiple\")\n          //TODO this.mixGen.transitionImmediatelyByCrossfadeAndBeatmatchToMultiple(newSong, oldDymo);\n          this.mixGen.transitionImmediatelyByCrossfadeAndBeatmatch(newSong);\n        }*/ else if (await this.analyzer.getKeyDistance(newSong, previousSong) <= 2) {\n          console.log(\"key similar\")\n          if (Math.random() > 0.5) {\n            transition = await this.mixGen.effects(newSong);\n          } else {\n            transition = await this.mixGen.echoFreeze(newSong);\n          }\n        } else {\n          console.log(\"give up\")\n          if (Math.random() > 0.5) {\n            transition = await this.mixGen.beatRepeat(newSong);\n          } else {\n            transition = await this.mixGen.powerDown(newSong);\n          }\n        }\n      } else if (await this.analyzer.getKeyDistance(newSong, previousSong) <= 2) {\n        console.log(\"key similar\")\n        transition = await this.mixGen.echoFreeze(newSong);\n      } else {\n        console.log(\"give up\")\n        if (Math.random() > 0.5) {\n          transition = await this.mixGen.beatRepeat(newSong);\n        } else {\n          transition = await this.mixGen.powerDown(newSong);\n        }\n      }\n    }\n    transition.decision = DecisionType.DecisionTree;\n    return transition;\n  }\n\n  private getRandomTransition(): (string) => Promise<Transition> {\n    const transitions: ((string) => Promise<Transition>)[] = [\n      (newDymo: string) => this.mixGen.beatmatchCrossfade(newDymo),\n      (newDymo: string) => this.mixGen.echoFreeze(newDymo),\n      (newDymo: string) => this.mixGen.slam(newDymo),\n      (newDymo: string) => this.mixGen.beatRepeat(newDymo),\n      (newDymo: string) => this.mixGen.crossfade(newDymo),\n      (newDymo: string) => this.mixGen.powerDown(newDymo),\n      (newDymo: string) => this.mixGen.effects(newDymo)\n    ];\n    return transitions[_.random(transitions.length)];\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/mix/auto-dj.ts","import * as _ from 'lodash';\nimport { DymoPlayer } from 'dymo-player';\nimport { DymoGenerator, ExpressionGenerator, SuperDymoStore, uris } from 'dymo-core';\nimport { Transition, TransitionType } from './types';\n\ninterface MixState {\n  removedOldSongBars: string[],\n  newSongBars: string[]\n}\n\nconst TRANSITION_OFFSET = 1; //number of bars from current position any transition starts\n\nexport class MixGenerator {\n\n  private mixDymoUri: string;\n  private songs: string[];\n  private store: SuperDymoStore;\n  private expressionGen: ExpressionGenerator;\n  private transitionConstraints: string[][] = []; //ARRAYS OF CONSTRAINT URIS FOR NOW\n\n  constructor(private generator: DymoGenerator, private player: DymoPlayer) {\n    this.store = generator.getStore();\n    this.expressionGen = new ExpressionGenerator(this.store);\n    this.init();\n  }\n\n  async init() {\n    this.songs = [];\n    this.mixDymoUri = await this.generator.addDymo();\n  }\n\n  getMixDymo(): string {\n    return this.mixDymoUri;\n  }\n\n  async startMixWithFadeIn(songUri: string, numBars = 2): Promise<Transition> {\n    const newSongBars = await this.registerSongAndGetBars(songUri);\n    const [duration, uris] = await this.applyFadeIn(newSongBars.slice(0, numBars));\n    const result = await this.endTransition(newSongBars, TransitionType.FadeIn, duration, uris);\n    //console.log(await this.store.lo)\n    return result;\n  }\n\n  async slam(songUri: string, offsetBars = 0): Promise<Transition> {\n    const state = await this.initTransition(songUri, offsetBars);\n    return this.endTransition(state.newSongBars, TransitionType.Slam, 0);\n  }\n\n  async beatRepeat(songUri: string, times = 3, offsetBars = 0): Promise<Transition> {\n    const state = await this.initTransition(songUri, offsetBars);\n    //add reverb to last bar\n    let lastBar = await this.findLastBar();\n    let lastBeat = await this.store.findPartAt(lastBar, 3);\n    await this.store.setParameter(lastBeat, uris.DELAY, 0.5);\n    //add silence for first part of bar\n    let lastBarDuration = await this.store.findFeatureValue(state.removedOldSongBars[0], uris.DURATION_FEATURE);\n    await this.addSilence(lastBarDuration/2);\n    //beat repeat\n    let firstBarBeats = await this.store.findParts(state.newSongBars[0]);\n    await this.addPartsToMix(_.fill(Array(times), firstBarBeats[0]));\n    return this.endTransition(state.newSongBars, TransitionType.BeatRepeat, 2); //duration just an estimate for now\n  }\n\n  async echoFreeze(songUri: string, numBarsBreak = 1): Promise<Transition> {\n    const state = await this.initTransition(songUri);\n    //delay out last bar\n    let lastBar = await this.findLastBar();\n    await this.store.setParameter(lastBar, uris.DELAY, 1);\n    //add silence for n bars\n    const lastBarDuration = await this.store.findFeatureValue(lastBar, uris.DURATION_FEATURE);\n    const silenceDuration = lastBarDuration*numBarsBreak;\n    await this.addSilence(silenceDuration);\n    return this.endTransition(state.newSongBars, TransitionType.EchoFreeze, lastBarDuration+silenceDuration);\n  }\n\n  async effects(songUri: string, numBars = 2, offsetBars = 0): Promise<Transition> {\n    const state = await this.initTransition(songUri, offsetBars);\n    //add effects to a few bars\n    const effectBars = state.removedOldSongBars.slice(0, numBars);\n    const duration = await this.getTotalDuration(effectBars);\n    const effectsRamp = await this.addRampWithTrigger(duration);\n    const reverb = await this.makeRampConstraint(effectsRamp, effectBars, 'Reverb(d) == r');\n    await this.addPartsToMix(effectBars);\n    return this.endTransition(state.newSongBars, TransitionType.Effects, duration, [effectsRamp, reverb]);\n  }\n\n  async powerDown(songUri: string, numBars = 2, numBarsBreak = 0): Promise<Transition> {\n    const state = await this.initTransition(songUri);\n    //add power down to a few bars\n    const powerBars = state.removedOldSongBars.slice(0, numBars);\n    //avg duration with linear ramp power down\n    const duration = 2 * (await this.getTotalDuration(powerBars));\n    const powerRamp = await this.addRampWithTrigger(duration);\n    const powerDown = await this.makeRampConstraint(powerRamp, powerBars, 'PlaybackRate(d) == 1-r');\n    const powerDown2 = await this.makeSetsConstraint(\n      [['d',powerBars]], 'DurationRatio(d) == 1/PlaybackRate(d)');\n    await this.loadTransition(powerRamp, powerDown, powerDown2);\n    await this.addPartsToMix(powerBars);\n    //add silence for n bars\n    const silenceDuration = (duration/2/numBars)*numBarsBreak;\n    await this.addSilence(silenceDuration);\n    //add new song\n    return this.endTransition(state.newSongBars, TransitionType.PowerDown, duration + silenceDuration);\n  }\n\n  async crossfade(songUri: string, numBars = 3, offsetBars = 0): Promise<Transition> {\n    const state = await this.initTransition(songUri, offsetBars);\n    const newSongTrans = state.newSongBars.slice(0, numBars);\n    const duration = await this.getTotalDuration(newSongTrans);\n    const oldSongTrans = await this.getInitialBars(state.removedOldSongBars, duration);\n    let uris = await this.applyCrossfade(oldSongTrans, newSongTrans, duration);\n    await this.addAligned(oldSongTrans, newSongTrans);\n    return this.endTransition(state.newSongBars.slice(numBars), TransitionType.Crossfade, duration, uris);\n  }\n\n  async beatmatchCrossfade(songUri: string, numBars = 3, offsetBars = 0): Promise<Transition> {\n    const state = await this.initTransition(songUri, offsetBars);\n    const newSongTrans = state.newSongBars.slice(0, numBars);\n    const oldSongTrans = state.removedOldSongBars.slice(0, numBars);\n    const duration = (await this.getTotalDuration(oldSongTrans.concat(newSongTrans)))/2 - 0.5;//minus schedule ahead time for more tempo smoothness!\n    //add constraints, controls, and triggers\n    let uris = await this.applyCrossfade(oldSongTrans, newSongTrans, duration);\n    //only beatmatch if same number of bars\n    if (newSongTrans.length == oldSongTrans.length) {\n      uris = uris.concat(await this.applyBeatmatch(oldSongTrans, newSongTrans, uris[0]));\n    }\n    //add transition part\n    await this.addZipped(oldSongTrans, newSongTrans);\n    return this.endTransition(state.newSongBars.slice(numBars), TransitionType.Beatmatch, duration, uris);\n  }\n\n  private async addPartsToMix(parts: string[]) {\n    return Promise.all(parts.map(p => this.store.addPart(this.mixDymoUri, p)));\n  }\n\n  private async addSilence(duration: number) {\n    if (duration > 0) {\n      let silence = await this.generator.addDymo();\n      await this.store.setFeature(silence, uris.DURATION_FEATURE, duration);\n      await this.addPartsToMix([silence]);\n    }\n  }\n\n  private async addAligned(bars1: string[], bars2: string[]): Promise<string> {\n    let bars1Seq = await this.generator.addDymo(null, null, uris.SEQUENCE);\n    await Promise.all(bars1.map(p => this.store.addPart(bars1Seq, p)));\n    let bars2Seq = await this.generator.addDymo(null, null, uris.SEQUENCE);\n    await Promise.all(bars2.map(p => this.store.addPart(bars2Seq, p)));\n    return await this.generator.addConjunction(this.mixDymoUri, [bars1Seq, bars2Seq]);\n  }\n\n  private async addZipped(bars1: string[], bars2: string[]) {\n    Promise.all(_.zip(bars1, bars2).map(bp =>\n      this.generator.addConjunction(this.mixDymoUri, bp)));\n  }\n\n  private async applyBeatmatch(oldSongBars: string[], newSongBars: string[], rampUri: string) {\n    //create tempo transition\n    let tempoParam = await this.generator.addCustomParameter(uris.CONTEXT_URI+\"Tempo\");\n    let newTempo = await this.getTempoFromBars(newSongBars);\n    let oldTempo = await this.getTempoFromBars(oldSongBars);\n    let tempoTransition = await this.makeSetsConstraint(\n      [['t',[tempoParam]], ['r',[rampUri]]], 't == r*'+newTempo+'+(1-r)*'+oldTempo);\n    //create beatmatch\n    let beats = _.flatten(await Promise.all(oldSongBars.concat(newSongBars).map(p => this.store.findParts(p))));\n    let beatMatch = await this.makeSetsConstraint(\n      [['d',beats], ['t',[tempoParam]]], 'TimeStretchRatio(d) == t/60*DurationFeature(d)');\n    let beatMatch2 = await this.makeSetsConstraint(\n      [['d',beats]], 'DurationRatio(d) == 1/TimeStretchRatio(d)');\n    console.log(\"beatmatched between tempos\", oldTempo, newTempo);\n    return [tempoTransition, beatMatch, beatMatch2];\n  }\n\n  private async applyFadeIn(newSongBarsParts: string[]): Promise<[number, string[]]> {\n    let fadeDuration = await this.getTotalDuration(newSongBarsParts);\n    let fadeRamp = await this.addRampWithTrigger(fadeDuration);\n    let fadeIn = await this.makeRampConstraint(fadeRamp, newSongBarsParts, 'Amplitude(d) == r');\n    console.log(\"fading in for\", newSongBarsParts.length, \"bars (\"+fadeDuration+\" seconds)\")\n    return [fadeDuration, [fadeRamp, fadeIn]]\n  }\n\n  private async applyCrossfade(oldSongParts: string[], newSongParts: string[], duration: number): Promise<string[]> {\n    let fadeRamp = await this.addRampWithTrigger(duration);\n    let fadeIn = await this.makeRampConstraint(fadeRamp, newSongParts, 'Amplitude(d) == r');\n    let fadeOut = await this.makeRampConstraint(fadeRamp, oldSongParts, 'Amplitude(d) == 1-r');\n    console.log(\"crossfading for\", newSongParts.length, \"bars (\"+duration+\" seconds)\");\n    return [fadeRamp, fadeIn, fadeOut];\n  }\n\n  //TODO dymo-core throws the occasional error due to list editing concurrency problem\n  private async addRandomBeatToLoop(songUri: string, loopDuration = 2): Promise<any> {\n    let currentBeats = await this.store.findParts(this.mixDymoUri);\n    //find a random beat in the song\n    let bars = await this.registerSongAndGetBars(songUri);\n    let randomBar = bars[_.random(bars.length)];\n    let randomBeat = (await this.store.findParts(randomBar))[_.random(4)];\n    if (currentBeats.length == 0) {\n      //add silence at beginning and end of loop to ensure constant length :/\n      let silenceUri = await this.generator.addDymo(this.mixDymoUri);\n      await this.store.setParameter(silenceUri, uris.ONSET, 0);\n      silenceUri = await this.generator.addDymo(this.mixDymoUri);\n      await this.store.setParameter(silenceUri, uris.ONSET, loopDuration);\n      currentBeats = await this.store.findParts(this.mixDymoUri);\n    }\n    //set a random onset and add the beat to the loop at correct position\n    let currentOnsets = await Promise.all(currentBeats.map(b => this.store.findParameterValue(b, uris.ONSET)));\n    let randomOnset = _.random(loopDuration, true);\n    await this.store.setParameter(randomBeat, uris.ONSET, randomOnset);\n    let beatPosition = currentOnsets.filter(o => o < randomOnset).length;\n    return this.store.insertPartAt(this.mixDymoUri, randomBeat, beatPosition);\n  }\n\n  async transitionImmediatelyToRandomBars(songUri: string, numBars = 2): Promise<any> {\n    let bars = await this.registerSongAndGetBars(songUri);\n    let randomBar = _.random(bars.length-numBars);\n    return Promise.all(bars.slice(randomBar, randomBar+numBars).map(p =>\n      this.store.addPart(this.mixDymoUri, p)));\n  }\n\n  /**loads the controls and constraints and adds the latter to the list*/\n  private async loadTransition(...uris: string[]): Promise<any> {\n    const loaded = await this.player.getDymoManager().loadFromStore(...uris);\n    //TODO NOW ADD CONSTRAINT TRIGGERS\n    await this.addConstraintTriggers(loaded.constraintUris);\n    this.transitionConstraints.push(loaded.constraintUris);\n  }\n\n  /**removes old song until current position + offset, registers new song and gets bars*/\n  private async initTransition(songUri: string, newOffsetBars?: number): Promise<MixState> {\n    const newSongBars = await this.registerSongAndGetBars(songUri, newOffsetBars);\n    const currentPos = await this.player.getPosition(this.mixDymoUri);\n    const offset = currentPos + TRANSITION_OFFSET;\n    const oldSongBars = await this.store.removeParts(this.mixDymoUri, offset);\n    return {removedOldSongBars: oldSongBars, newSongBars: newSongBars};\n  }\n\n  /**adds new song bars and returns transition object*/\n  private async endTransition(newSongBars: string[], type: TransitionType, duration: number, transitionUris?: string[]): Promise<Transition> {\n    if (uris) await this.loadTransition(...transitionUris);\n    await this.addPartsToMix(newSongBars);\n    return this.getTransitionObject(type, duration);\n  }\n\n  private async registerSongAndGetBars(songUri: string, offset = 0): Promise<string[]> {\n    this.songs.push(songUri);\n    let bars = await this.store.findParts(songUri);\n    return bars.slice(offset);\n  }\n\n  private async addRampWithTrigger(duration: number) {\n    const rampUri = await this.generator.addRampControl(0, duration, 100);\n    await this.addControlTrigger(rampUri);\n    return rampUri;\n  }\n\n  private async addControlTrigger(controlUri: string) {\n    const trigger = await this.store\n      .setControlParam(controlUri, uris.AUTO_CONTROL_TRIGGER, 0);\n    await this.generator.addEvent(this.mixDymoUri, trigger, 1);\n  }\n\n  private async addConstraintTriggers(newUris: string[]) {\n    if (this.transitionConstraints.length > 1) {\n      const previousConstraints = _.last(this.transitionConstraints);\n      /*TODO ADD EVENT TO DEACTIVATE PREVIOUS CONSTRAINTS AND ACTIVATE NEW ONES\n      this.store.deactivateConstraints(previousConstraints);*/\n    }\n  }\n\n  private async makeCrossfade(rampUri: string, oldSongUris: string[], newSongUris: string[]): Promise<string[]> {\n    var fadeOut = await this.makeRampConstraint(rampUri, oldSongUris, 'Amplitude(d) == 1-r');\n    var fadeIn = await this.makeRampConstraint(rampUri, newSongUris, 'Amplitude(d) == r');\n    /*var fadeOut2 = await this.makeRampConstraint(rampUri, oldSongUris, 'DurationRatio(d) == 1/(1-r)');\n    var fadeIn2 = await this.makeRampConstraint(rampUri, newSongUris, 'DurationRatio(d) == 1/r');*/\n    return [fadeOut, fadeIn].filter(c => c); //remove undefined\n  }\n\n  private makeRampConstraint(rampUri: string, dymoUris: string[], expression: string): Promise<string> {\n    if (dymoUris.length > 0) {\n      return this.makeSetsConstraint([['d',dymoUris], ['r',[rampUri]]], expression);\n    }\n  }\n\n  private makeSetsConstraint(sets: [string,string[]][], expression: string): Promise<string> {\n    let vars = sets.map(s => '∀ '+s[0]+' in '+JSON.stringify(s[1])+' => ').join('');\n    return this.expressionGen.addConstraint(this.mixDymoUri, vars+expression, true);\n  }\n\n  private async getTempoFromBars(barUris: string[]): Promise<number> {\n    let avgDuration = _.mean(await this.getFeature(barUris, uris.DURATION_FEATURE));\n    return 60/(avgDuration/4);\n  }\n\n  //returns an initial segment of bars with at most the given duration\n  private async getInitialBars(bars: string[], duration: number): Promise<string[]> {\n    let currentDuration = 0;\n    return _.takeWhile(bars, async (b,i) => {\n      currentDuration += await this.store.findFeatureValue(b, uris.DURATION_FEATURE);\n      return currentDuration < duration;\n    });\n  }\n\n  /**returns the last bars*/\n  private async findLastBar() {\n    //return (await this.store.findParts(this.mixDymoUri)).slice(-n);\n    return _.last(await this.store.findParts(this.mixDymoUri));\n  }\n\n  private async getTotalDuration(dymoUris: string[]): Promise<number> {\n    return _.sum(await this.getFeature(dymoUris, uris.DURATION_FEATURE));\n  }\n\n  private async getFeature(dymoUris: string[], featureUri: string): Promise<number[]> {\n    return Promise.all(dymoUris.map(d => this.store.findFeatureValue(d, featureUri)));\n  }\n\n  private getTransitionObject(type: TransitionType, duration: number): Transition {\n    return {\n      date: new Date(Date.now()),\n      user: null,\n      rating: null,\n      names: null,\n      features: null,\n      decision: null,\n      type: type,\n      parameters: null,\n      duration: duration\n    }\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/mix/mix-generator.ts","export interface Value<T> {\n  value: T;\n}\n\nexport interface Beat {\n  time: Value<number>;\n  label: Value<string>;\n}\n\nexport interface Key {\n  time: Value<number>;\n  value: number;\n}\n\nexport interface FeatureExtractor {\n  extractBeats(buffer: AudioBuffer): Promise<Beat[]>;\n  extractKey(buffer: AudioBuffer): Promise<Key[]>;\n}\n\nexport enum DecisionType {\n  Default,\n  Random,\n  DecisionTree\n}\n\nexport enum TransitionType {\n  FadeIn,\n  Slam,\n  BeatRepeat,\n  Crossfade,\n  Beatmatch,\n  BeatmatchMultiple,\n  EchoFreeze,\n  PowerDown,\n  Effects\n}\n\nexport interface Transition {\n  type: TransitionType,\n  duration: number,\n  date: Date,\n  user: string,\n  rating: number,\n  names: string[],\n  features: number[],\n  decision: DecisionType,\n  parameters: number[]\n}\n\n\n// WEBPACK FOOTER //\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/mix/types.ts","/**\n * @function _guid\n * @description Creates GUID for user based on several different browser variables\n * It will never be RFC4122 compliant but it is robust\n * @returns {Number}\n * @private\n */\nexport function getGuid() {\n\n    var nav = window.navigator;\n    var screen = window.screen;\n    var guid: string = nav.mimeTypes.length.toString();\n    guid += nav.userAgent.replace(/\\D+/g, '');\n    guid += nav.plugins.length;\n    guid += screen.height || '';\n    guid += screen.width || '';\n    guid += screen.pixelDepth || '';\n\n    return guid;\n};\n\n\n// WEBPACK FOOTER //\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/app/util.ts","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `.angular-cli.json`.\n\nexport const environment = {\n  production: false\n};\n\n\n\n// WEBPACK FOOTER //\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/environments/environment.ts","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule);\n\n\n\n// WEBPACK FOOTER //\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/src/main.ts","var map = {\n\t\"./N3Lexer\": \"../../../../n3/lib/N3Lexer.js\",\n\t\"./N3Lexer.js\": \"../../../../n3/lib/N3Lexer.js\",\n\t\"./N3Parser\": \"../../../../n3/lib/N3Parser.js\",\n\t\"./N3Parser.js\": \"../../../../n3/lib/N3Parser.js\",\n\t\"./N3Store\": \"../../../../n3/lib/N3Store.js\",\n\t\"./N3Store.js\": \"../../../../n3/lib/N3Store.js\",\n\t\"./N3StreamParser\": \"../../../../n3/lib/N3StreamParser.js\",\n\t\"./N3StreamParser.js\": \"../../../../n3/lib/N3StreamParser.js\",\n\t\"./N3StreamWriter\": \"../../../../n3/lib/N3StreamWriter.js\",\n\t\"./N3StreamWriter.js\": \"../../../../n3/lib/N3StreamWriter.js\",\n\t\"./N3Util\": \"../../../../n3/lib/N3Util.js\",\n\t\"./N3Util.js\": \"../../../../n3/lib/N3Util.js\",\n\t\"./N3Writer\": \"../../../../n3/lib/N3Writer.js\",\n\t\"./N3Writer.js\": \"../../../../n3/lib/N3Writer.js\"\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"../../../../n3/lib recursive ^\\\\.\\\\/N3.*$\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// /Users/flo/Projects/Code/FAST/fast-dj/fast-dj/node_modules/n3/lib ^\\.\\/N3.*$\n// module id = ../../../../n3/lib recursive ^\\.\\/N3.*$\n// module chunks = main","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// util (ignored)\n// module id = 1\n// module chunks = main","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// vertx (ignored)\n// module id = 2\n// module chunks = main"],"sourceRoot":"webpack:///"}