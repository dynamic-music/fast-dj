{"version":3,"sources":["/Users/lucas/code/fast-dj/src/$_gendir lazy","/Users/lucas/code/fast-dj/src/app/app.component.css","/Users/lucas/code/fast-dj/src/app/app.component.html","/Users/lucas/code/fast-dj/src/app/app.component.ts","/Users/lucas/code/fast-dj/src/app/app.module.ts","/Users/lucas/code/fast-dj/src/app/mix/mix-generator.ts","/Users/lucas/code/fast-dj/src/app/services/feature-extraction/feature-extraction.service.ts","/Users/lucas/code/fast-dj/src/environments/environment.ts","/Users/lucas/code/fast-dj/src/main.ts","/Users/lucas/code/fast-dj/node_modules/n3/lib ^\\.\\/N3.*$","util (ignored)","vertx (ignored)"],"names":[],"mappings":"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","file":"main.bundle.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\treturn new Promise(function(resolve, reject) { reject(new Error(\"Cannot find module '\" + req + \"'.\")); });\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"../../../../../src/$$_gendir lazy recursive\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// /Users/lucas/code/fast-dj/src/$$_gendir lazy\n// module id = ../../../../../src/$$_gendir lazy recursive\n// module chunks = main","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".custom-component-drop-zone {\\n  width: 100%;\\n  height: 100%;\\n}\\n\\n.status-indicator {\\n  width: 100%;\\n  height: 100%;\\n  opacity: 0.75;\\n  transition: opacity 0.1s ease-in-out;\\n}\\n\\n.beat {\\n  opacity: 1.0\\n}\", \"\"]);\n\n// exports\n\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = module.exports.toString();\n\n\n//////////////////\n// WEBPACK FOOTER\n// /Users/lucas/code/fast-dj/src/app/app.component.css\n// module id = ../../../../../src/app/app.component.css\n// module chunks = main","module.exports = \"<!--The content below is only a placeholder and can be replaced.-->\\n<div\\n  ng2FileDrop\\n  class=\\\"custom-component-drop-zone\\\"\\n  (ng2FileDropFileAccepted)=\\\"dragFileAccepted($event)\\\"\\n>\\n  <div\\n  [ngClass]=\\\"{beat: currentStyle.isBeat, 'status-indicator': true}\\\"\\n  [style.backgroundColor]=\\\"currentStyle.colour\\\"\\n  ></div>\\n</div>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// /Users/lucas/code/fast-dj/src/app/app.component.html\n// module id = ../../../../../src/app/app.component.html\n// module chunks = main","import * as _ from 'lodash';\nimport { Component } from '@angular/core';\nimport { Ng2FileDropAcceptedFile } from 'ng2-file-drop';\nimport { DymoGenerator, DymoTemplates, DymoManager, GlobalVars, uris } from 'dymo-core';\nimport { MixGenerator } from './mix/mix-generator';\nimport {\n  FeatureExtractionService\n} from './services/feature-extraction/feature-extraction.service';\n\nfunction* createColourCycleIterator(colours) {\n  let index = 0;\n  const nColours = colours.length;\n  while (true) {\n    yield colours[index = ++index % nColours];\n  }\n}\n\ninterface IndicatorStyle {\n  isBeat: boolean;\n  colour: string;\n}\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent {\n  title = 'app';\n  private dymoGen: DymoGenerator;\n  private mixGen: MixGenerator;\n  private manager: DymoManager;\n  private isPlaying = false;\n  private previousDymos = [];\n  private currentStyle: IndicatorStyle;\n  private cyclicColours: Iterator<string>;\n\n  constructor(private extractionService: FeatureExtractionService) {\n    GlobalVars.LOGGING_ON = true;\n    this.cyclicColours = createColourCycleIterator([\n      '#5bc0eb',\n      '#fde74c',\n      '#9bc53d',\n      '#e55934',\n      '#fa7921'\n    ]);\n    this.currentStyle = {\n      isBeat: false,\n      colour: this.getNextColour()\n    };\n    this.manager = new DymoManager();\n    this.manager.init('https://semantic-player.github.io/dymo-core/ontologies/')\n      .then(() => {\n        let store = this.manager.getStore();\n        this.dymoGen = new DymoGenerator(store);\n        this.mixGen = new MixGenerator(this.dymoGen, this.manager);\n      });\n    this.manager.getPlayingDymoUris()\n      .subscribe(updatedDymos => {\n        const nChanged = _.difference(updatedDymos, this.previousDymos).length;\n        if (nChanged > 0) {\n          const trackChanged = nChanged === this.previousDymos.length;\n          if (trackChanged) {\n            // TODO identify which track is playing, and associate with a specific colour\n            this.currentStyle = {\n              colour: this.getNextColour(),\n              isBeat: true\n            };\n          } else {\n            this.currentStyle = {\n              ...this.currentStyle,\n              isBeat: true\n            };\n          }\n        } else {\n          this.currentStyle = {\n            ...this.currentStyle,\n            isBeat: false\n          };\n        }\n        this.previousDymos = updatedDymos;\n      });\n  }\n\n  private dragFileAccepted(acceptedFile: Ng2FileDropAcceptedFile) {\n    const url = URL.createObjectURL(acceptedFile.file);\n    this.manager.getAudioBank().loadBuffer(url)\n      .then(buffer => this.extractionService.extractBeats(buffer))\n      .then(beats => DymoTemplates.createAnnotatedBarAndBeatDymo2(this.dymoGen, url, beats))\n      .then(newDymo => this.manager.loadFromStore(\n          newDymo\n        ).then(() => this.mixGen.transitionImmediatelyToRandomBars(newDymo, 2))\n      )\n      .then(mixDymo => this.keepOnPlaying(mixDymo));\n  }\n\n  private keepOnPlaying(dymoUri: string) {\n    if (!this.isPlaying) {\n      this.isPlaying = true;\n      this.manager.startPlayingUri(dymoUri);\n    }\n  }\n\n  private getNextColour(): string {\n    return this.cyclicColours.next().value;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// /Users/lucas/code/fast-dj/src/app/app.component.ts","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { AppComponent } from './app.component';\nimport { Ng2FileDropModule } from 'ng2-file-drop';\nimport {\n  FeatureExtractionService\n} from './services/feature-extraction/feature-extraction.service';\n\n@NgModule({\n  declarations: [\n    AppComponent\n  ],\n  imports: [\n    BrowserModule,\n    Ng2FileDropModule\n  ],\n  providers: [\n    FeatureExtractionService\n  ],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n\n\n\n// WEBPACK FOOTER //\n// /Users/lucas/code/fast-dj/src/app/app.module.ts","import * as _ from 'lodash';\nimport { DymoGenerator, ExpressionGenerator, DymoManager, uris } from 'dymo-core';\n\nexport class MixGenerator {\n\n  private mixDymoUri: string;\n  private expressionGen;\n\n  constructor(private generator: DymoGenerator, private manager: DymoManager) {\n    this.expressionGen = new ExpressionGenerator(generator.getStore());\n  }\n\n  getMixDymo() {\n    return this.mixDymoUri;\n  }\n\n  transitionImmediatelyToRandomBars(songDymoUri: string, durationInBars: number): string {\n    if (!this.mixDymoUri) {\n      this.mixDymoUri = this.generator.addDymo();\n    }\n    let songParts = this.generator.getStore().findParts(songDymoUri);\n    let randomBar = _.random(songParts.length-durationInBars);\n    songParts.slice(randomBar, randomBar+durationInBars).forEach(p =>\n      this.generator.getStore().addPart(this.mixDymoUri, p));\n    return this.mixDymoUri;\n  }\n\n  transitionImmediatelyByCrossfade(songDymoUri: string, duration: number): string {\n    if (!this.mixDymoUri) {\n      this.mixDymoUri = this.generator.addDymo();\n    }\n    let newSongParts = this.generator.getStore().findParts(songDymoUri);\n\n    let currentPosition = this.manager.getNavigatorPosition(this.mixDymoUri, 1);\n    console.log(currentPosition)\n\n    let ramp = this.generator.addControl('', uris.RAMP);\n\n    let removedParts;\n\n    if (currentPosition) {\n      removedParts = this.generator.getStore().removeParts(this.mixDymoUri, currentPosition+1);\n\n      _.range(0, duration).forEach(i => {\n        var currentTransitionPart = this.generator.addDymo(this.mixDymoUri, null, uris.CONJUNCTION);\n        this.generator.getStore().addPart(currentTransitionPart, removedParts[i]);\n        this.generator.getStore().addPart(currentTransitionPart, newSongParts[i]);\n      });\n\n      this.expressionGen.addConstraint(this.mixDymoUri,\n        '∀ d in '+JSON.stringify(removedParts)+' => ∀ r in [\"'+ramp+'\"] => Amplitude(x) == 1-r');\n    }\n\n    newSongParts.slice(duration).forEach(p => this.generator.getStore().addPart(this.mixDymoUri, p));\n\n    console.log('∀ d in '+JSON.stringify(newSongParts)+' => ∀ r in [\"'+ramp+'\"] => Amplitude(x) == 1-r')\n\n    var constraint = this.expressionGen.addConstraint(this.mixDymoUri,\n      '∀ d in '+JSON.stringify(newSongParts)+' => ∀ r in [\"'+ramp+'\"] => Amplitude(x) == r');\n\n    //TODO LOAD CONSTRAINTS\n\n    return this.mixDymoUri;\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// /Users/lucas/code/fast-dj/src/app/mix/mix-generator.ts","import { Injectable } from '@angular/core';\nimport {\n  OneShotExtractionClient,\n  OneShotExtractionRequest as Request,\n  OneShotExtractionResponse as Response,\n  OneShotExtractionScheme\n} from 'piper-js/one-shot';\nimport { FeatureList } from 'piper-js/core';\nimport { toSeconds } from 'piper-js/time';\nimport createQmWorker from '@extractors/qm';\n\n// this spawns a web worker, which we only want to do once\n// so we instantiate \nconst qmWorker = createQmWorker();\n\nexport interface Value<T> {\n  value: T;\n}\nexport interface Beat {\n  time: Value<number>;\n  label: Value<string>;\n}\n\ninterface AudioData {\n  channels: Float32Array[];\n  sampleRate: number;\n  duration: number;\n}\n\nfunction bufferToAudioData(buffer: AudioBuffer): AudioData {\n  const nChannels = buffer.numberOfChannels;\n  const channels = new Array<Float32Array>(nChannels);\n  for (let i = 0; i < nChannels; ++i) {\n    channels[i] = buffer.getChannelData(i);\n  }\n  return {\n    channels,\n    sampleRate: buffer.sampleRate,\n    duration: buffer.duration\n  };\n}\n\n@Injectable()\nexport class FeatureExtractionService {\n  private client: OneShotExtractionClient;\n\n  constructor() {\n    this.client = new OneShotExtractionClient(\n      qmWorker,\n      OneShotExtractionScheme.REMOTE\n    );\n  }\n\n  extract(request: Request): Promise<Response> {\n    return this.client.collect(request);\n  }\n\n  extractBeats(buffer: AudioBuffer): Promise<Beat[]> {\n    const {channels, sampleRate} = bufferToAudioData(buffer);\n    return this.extract({\n      audioData: channels,\n      audioFormat: {\n        sampleRate,\n        channelCount: channels.length\n      },\n      key: 'qm-vamp-plugins:qm-barbeattracker',\n      outputId: 'beats'\n    }).then(mapFeaturesToBeats);\n  }\n}\n\nfunction mapFeaturesToBeats(response: Response): Beat[] {\n  // TODO ought to actually validate the shape / type\n  const featureData: FeatureList = response.features.collected as FeatureList;\n  return featureData.map(feature => ({\n    time: {value: toSeconds(feature.timestamp)},\n    label: {value: feature.label}\n  }));\n}\n\n\n// WEBPACK FOOTER //\n// /Users/lucas/code/fast-dj/src/app/services/feature-extraction/feature-extraction.service.ts","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `.angular-cli.json`.\n\nexport const environment = {\n  production: false\n};\n\n\n\n// WEBPACK FOOTER //\n// /Users/lucas/code/fast-dj/src/environments/environment.ts","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule);\n\n\n\n// WEBPACK FOOTER //\n// /Users/lucas/code/fast-dj/src/main.ts","var map = {\n\t\"./N3Lexer\": \"../../../../n3/lib/N3Lexer.js\",\n\t\"./N3Lexer.js\": \"../../../../n3/lib/N3Lexer.js\",\n\t\"./N3Parser\": \"../../../../n3/lib/N3Parser.js\",\n\t\"./N3Parser.js\": \"../../../../n3/lib/N3Parser.js\",\n\t\"./N3Store\": \"../../../../n3/lib/N3Store.js\",\n\t\"./N3Store.js\": \"../../../../n3/lib/N3Store.js\",\n\t\"./N3StreamParser\": \"../../../../n3/lib/N3StreamParser.js\",\n\t\"./N3StreamParser.js\": \"../../../../n3/lib/N3StreamParser.js\",\n\t\"./N3StreamWriter\": \"../../../../n3/lib/N3StreamWriter.js\",\n\t\"./N3StreamWriter.js\": \"../../../../n3/lib/N3StreamWriter.js\",\n\t\"./N3Util\": \"../../../../n3/lib/N3Util.js\",\n\t\"./N3Util.js\": \"../../../../n3/lib/N3Util.js\",\n\t\"./N3Writer\": \"../../../../n3/lib/N3Writer.js\",\n\t\"./N3Writer.js\": \"../../../../n3/lib/N3Writer.js\"\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"../../../../n3/lib recursive ^\\\\.\\\\/N3.*$\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// /Users/lucas/code/fast-dj/node_modules/n3/lib ^\\.\\/N3.*$\n// module id = ../../../../n3/lib recursive ^\\.\\/N3.*$\n// module chunks = main","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// util (ignored)\n// module id = 1\n// module chunks = main","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// vertx (ignored)\n// module id = 2\n// module chunks = main"],"sourceRoot":"webpack:///"}